<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Comprehensive Dev UI Demo - Klecks</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: system-ui, -apple-system, sans-serif;
            background: #f0f0f0;
            overflow: hidden;
        }
        
        #loading {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            font-size: 18px;
            color: #333;
        }
        
        #container {
            display: none; /* Hidden until loaded */
        }
        
        .demo-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 8px 15px;
            font-size: 12px;
            z-index: 10000;
            text-align: center;
        }
        
        .keyboard-shortcuts {
            font-size: 10px;
            opacity: 0.8;
            margin-top: 2px;
        }
    </style>
</head>
<body>
    <div class="demo-overlay">
        <div><strong>üé® Comprehensive Dev UI Demo</strong> - Every API feature exposed for testing</div>
        <div class="keyboard-shortcuts">
            Shortcuts: B=Brush, T=Text, F=Fill, G=Gradient, [/]=Size, X=Swap Colors, Ctrl+Z=Undo, Ctrl+Y=Redo
        </div>
    </div>
    
    <div id="loading">
        <div>üé® Loading Comprehensive Dev UI...</div>
        <div style="margin-top: 10px; font-size: 14px; color: #666;">
            Initializing full API testing interface
        </div>
    </div>
    
    <div id="container"></div>
    
    <script type="module">
        async function initDemo() {
            try {
                // Import the development version with comprehensive UI
                const { createDevKlecks } = await import('./dist/dev-with-ui.js');
                
                // Create the comprehensive dev instance
                const devKlecks = await createDevKlecks({
                    width: 1024,
                    height: 768,
                    showUI: true,
                    useComprehensiveUI: true // This enables the exhaustive dev UI
                });
                
                // Add to container
                const container = document.getElementById('container');
                const loadingDiv = document.getElementById('loading');
                
                container.appendChild(devKlecks.getElement());
                
                // Hide loading, show container
                loadingDiv.style.display = 'none';
                container.style.display = 'block';
                
                // Make API available globally for console testing
                window.devKlecks = devKlecks;
                window.api = devKlecks.getApi();
                window.manager = devKlecks.getManager();
                window.ui = devKlecks.getComprehensiveUI();
                
                console.log('üé® Comprehensive Dev UI loaded!');
                console.log('Available globals: devKlecks, api, manager, ui');
                console.log('Example usage:');
                console.log('  api.setBrushSize(50);');
                console.log('  api.createLayer("New Layer");');
                console.log('  api.drawLine(0, 0, 100, 100);');
                
                // Demo some features on startup
                setTimeout(() => {
                    // Create a couple test layers
                    devKlecks.getApi().createLayer('Demo Layer 1');
                    devKlecks.getApi().createLayer('Demo Layer 2');
                    
                    // Set some brush properties
                    devKlecks.getApi().setBrushSize(25);
                    devKlecks.getApi().setBrushOpacity(0.8);
                    devKlecks.getApi().setPrimaryColor({ r: 255, g: 100, b: 100 });
                    
                    console.log('‚ú® Demo setup complete - try drawing on the canvas!');
                }, 1000);
                
            } catch (error) {
                console.error('Failed to initialize comprehensive dev UI:', error);
                document.getElementById('loading').innerHTML = `
                    <div style="color: red;">‚ùå Failed to load</div>
                    <div style="font-size: 12px; margin-top: 10px;">
                        ${error.message}
                    </div>
                    <div style="font-size: 10px; margin-top: 5px; color: #666;">
                        Make sure the build has been completed
                    </div>
                `;
            }
        }
        
        // Initialize when page loads
        initDemo();
        
        // Add some helpful console functions
        window.testAPI = {
            drawTestPattern: () => {
                const api = window.api;
                api.setCurrentTool('brush');
                api.setBrushSize(10);
                
                // Draw a test pattern
                for (let i = 0; i < 5; i++) {
                    api.setPrimaryColor({ 
                        r: Math.floor(Math.random() * 255), 
                        g: Math.floor(Math.random() * 255), 
                        b: Math.floor(Math.random() * 255) 
                    });
                    api.drawLine(i * 50, 100, i * 50 + 100, 200);
                }
                console.log('‚ú® Test pattern drawn!');
            },
            
            createColorLayers: () => {
                const api = window.api;
                const colors = [
                    { r: 255, g: 0, b: 0, name: 'Red Layer' },
                    { r: 0, g: 255, b: 0, name: 'Green Layer' },
                    { r: 0, g: 0, b: 255, name: 'Blue Layer' }
                ];
                
                colors.forEach(color => {
                    api.createLayer(color.name);
                    const layerIndex = api.getLayerCount() - 1;
                    api.setActiveLayer(layerIndex);
                    api.fillLayer(layerIndex, color);
                    api.setLayerOpacity(layerIndex, 0.3);
                });
                console.log('üé® Color layers created!');
            },
            
            stressTest: () => {
                const api = window.api;
                console.log('üî• Starting stress test...');
                
                // Create multiple layers
                for (let i = 0; i < 10; i++) {
                    api.createLayer(`Stress Layer ${i + 1}`);
                }
                
                // Draw random lines
                for (let i = 0; i < 100; i++) {
                    api.setPrimaryColor({
                        r: Math.floor(Math.random() * 255),
                        g: Math.floor(Math.random() * 255),
                        b: Math.floor(Math.random() * 255)
                    });
                    api.drawLine(
                        Math.random() * 800,
                        Math.random() * 600,
                        Math.random() * 800,
                        Math.random() * 600
                    );
                }
                
                console.log('üî• Stress test complete!');
            }
        };
        
        console.log('üí° Helper functions available: testAPI.drawTestPattern(), testAPI.createColorLayers(), testAPI.stressTest()');
    </script>
</body>
</html>

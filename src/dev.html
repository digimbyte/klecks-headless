<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Klecks Dev - Enhanced Basic HTML UI</title>
    <style>
        /* MINIMAL STYLING FOR READABILITY */
        body {
            font-family: system-ui, monospace, sans-serif;
            margin: 0;
            padding: 10px;
            background: #f5f5f5;
            color: #333;
            font-size: 13px;
        }
        
        h1 {
            color: #2c3e50;
            margin-bottom: 10px;
        }
        
        fieldset {
            margin-bottom: 8px;
            border: 1px solid #ccc;
            border-radius: 3px;
            padding: 8px;
        }
        
        legend {
            font-weight: bold;
            padding: 0 5px;
            color: #2c3e50;
        }
        
        button {
            margin: 2px;
            padding: 4px 8px;
            border: 1px solid #999;
            background: white;
            cursor: pointer;
        }
        
        button:hover {
            background: #e6f3ff;
        }
        
        input, select, textarea {
            margin: 2px;
            font-family: inherit;
            font-size: inherit;
        }
        
        #loading {
            text-align: center;
            font-size: 18px;
            margin-top: 100px;
        }
        
        #debug-info {
            font-size: 11px;
            font-family: monospace;
        }
    </style>
</head>
<body>
    <div id="loading">üîß Loading Enhanced Basic HTML Dev UI...</div>
    <div id="container" style="display: none;"></div>
    
    <script type="module">
        async function initEnhancedBasicUI() {
            try {
                console.log('üöÄ Initializing Enhanced Basic HTML Dev UI...');
                
                // Import the development version with enhanced basic HTML UI
                const { createDevKlecks } = await import('./dev-with-ui.ts');
                
                console.log('üì¶ Module loaded, creating dev instance...');
                
                // Create the enhanced basic HTML dev instance with ALL FEATURES
                const devKlecks = await createDevKlecks({
                    width: 800,
                    height: 600,
                    showUI: true,
                    useBasicHtmlUI: true  // This enables ENHANCED raw HTML with ALL filters, shapes, gradients!
                });
                
                console.log('‚ú® Dev instance created successfully!');
                
                // Add to container
                const container = document.getElementById('container');
                const loadingDiv = document.getElementById('loading');
                
                container.appendChild(devKlecks.getElement());
                
                // Hide loading, show container
                loadingDiv.style.display = 'none';
                container.style.display = 'block';
                
                // Make API available globally for console testing
                window.devKlecks = devKlecks;
                window.api = devKlecks.getApi();
                window.manager = devKlecks.getManager();
                window.basicUI = devKlecks.getBasicHtmlUI();
                window.filters = devKlecks.getApi().filters;
                window.shapes = devKlecks.getApi().shapes;
                window.gradients = devKlecks.getApi().gradients;
                
                console.log('üîß ENHANCED Basic HTML UI loaded successfully!');
                console.log('üé® ALL KLECKS FEATURES EXPOSED IN RAW HTML:');
                console.log('   ‚Ä¢ Complete Filter System (blur, brightness, hue, etc.)');
                console.log('   ‚Ä¢ Complete Shape Tools (rectangles, ellipses, circles, lines)');
                console.log('   ‚Ä¢ Complete Gradient Tools (linear, radial, mirror)');
                console.log('   ‚Ä¢ Layer Management (create, delete, merge, etc.)');
                console.log('   ‚Ä¢ Brush Tools & Color Management');
                console.log('   ‚Ä¢ Text Tools & History (undo/redo)');
                console.log('   ‚Ä¢ API Tester for live coding');
                console.log('');
                console.log('Available globals: devKlecks, api, manager, basicUI, filters, shapes, gradients');
                console.log('');
                console.log('üß™ Quick test commands:');
                console.log('  api.setBrushSize(50);');
                console.log('  api.filters.applyInvert();');
                console.log('  api.shapes.drawCircle(100, 100, 50, {r:255,g:0,b:0});');
                console.log('  api.gradients.createLinearGradient(0,0,200,200,{r:0,g:255,b:0});');
                console.log('  api.createLayer("Test Layer");');
                
                // Demo some features on startup
                setTimeout(() => {
                    // Set some properties
                    devKlecks.getApi().setBrushSize(15);
                    devKlecks.getApi().setPrimaryColor({ r: 72, g: 133, b: 237 });
                    
                    console.log('‚ú® Ready! Try the RAW HTML controls - every Klecks feature available!');
                }, 500);
                
            } catch (error) {
                console.error('‚ùå Failed to initialize enhanced basic HTML UI:', error);
                document.getElementById('loading').innerHTML = `
                    <div style="color: red; font-weight: bold;">‚ùå Failed to Load Enhanced Basic UI</div>
                    <div style="font-size: 14px; margin-top: 10px; color: #666;">
                        ${error.message}
                    </div>
                    <div style="font-size: 12px; margin-top: 10px; color: #999;">
                        Stack: ${error.stack}
                    </div>
                `;
            }
        }
        
        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', initEnhancedBasicUI);
        
        // Also try immediate init in case DOMContentLoaded already fired
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initEnhancedBasicUI);
        } else {
            initEnhancedBasicUI();
        }
    </script>
</body>
</html>
